

# This file was *autogenerated* from the file poseidonperm_bls12_381_new_width3.sage
from sage.all_cmdline import *   # import sage library

_sage_const_765 = Integer(765); _sage_const_2 = Integer(2); _sage_const_1 = Integer(1); _sage_const_8 = Integer(8); _sage_const_55 = Integer(55); _sage_const_0x58bb7f6cf05bd874fbed5cb8c4bd3dd98595441902ad000188da7a0000000001 = Integer(0x58bb7f6cf05bd874fbed5cb8c4bd3dd98595441902ad000188da7a0000000001); _sage_const_0 = Integer(0); _sage_const_16 = Integer(16); _sage_const_4 = Integer(4); _sage_const_5 = Integer(5)# adapted from Xuyang file (poseidonperm_bls12_377_width3.sage), adapted from https://extgit.iaik.tugraz.at/krypto/hadeshash/-/blob/master/code/poseidonperm_x5_255_3.sage

# M = 128
N = _sage_const_765 
arity = _sage_const_2 
t = arity + _sage_const_1 
n = int(N / t)
R_F = _sage_const_8 
R_P = _sage_const_55 
prime = _sage_const_0x58bb7f6cf05bd874fbed5cb8c4bd3dd98595441902ad000188da7a0000000001 
F = GF(prime)

round_constants = ['0x1c07c723706e180aba8f86d0b2d1f1c8f09331f35902cbd21a1b77d100157c2a', '0x069939832dd245af3bc2a5167d58811814a2fa1f5399895e67b3cfd636b7885c', '0x05f27ee938066d35d45cc253ee33cf58db658a6dbd04efa529614b6c709b56c5', '0x4c33b40f0116518c7a967258ac518eb9de652c91338d6a2a137a6173657a37de', '0x3f1ca7c11e28100e56ebe179159c4d0fe8ee745e37cee6c400490b96214f3610', '0x020cf330725eb29ea090cb84e8240606f9f3892f2cf79908fab71a06e2774068', '0x4bd72f77a0ec97d039014400ee028a2ef736ca19c4bc3a28f82ffd6de73517fb', '0x08544715db1335dd6fed642621bb8f1bf03521793b64c5c22d28bd46c1e548a5', '0x26babfec1c990be50c2de2f3dec4aed0a83483a2ac231f356414de7a8eac076e', '0x1fcbdb56272aae4626f787463517d15576f727389ee18dbf8c7b24ddbeaf05f4', '0x24024a3658da9e97e94c38ad40326b46e3715febba9b359bbc705f3c6da65a46', '0x16748f1925711b91a943900486ea9f692cf937081027c719233a02aad5beaf0d', '0x1cbfe7855c0e20303f260536bec1c85913bd7c803e54a80c08ba4f292da6b952', '0x4351ec0693e43957430b2bf30506d65111bf0311a63a54faaec02ee7e37382d7', '0x2f57d57a9f4e7f65afffdeaf118ddc578ff54986f0c6423be67ef642f35dc0bb', '0x2cbd03dae30133f99798e97142f96546c14ab55a9f71b08d23e632df261b95fb', '0x1c61b2013f74d87e5f4cae0bb683f0cf9ac28b85d03a36948797f8bef61f2c7e', '0x56fce4f995b862924aa988ab85cf42dffd90b071016f6523d7b61d634f15f8a5', '0x435db32a86baf237109df01ac09b4ab7ece907723a8624796615ce6e6b563e30', '0x0770749c219fdde970efe9412b405e3ea8496956dcfd676897c3b11a475399fb', '0x0ea1cebad5b1635acd5f1d0ecfb3817f2efe75f63758cfce88e05f9d3917eb26', '0x4a737cec75595692230acee973defef29aa3280cb7f1c2b7fc501509733d7bf6', '0x0aaa44bdb34f82e83f8521c97fd37f064117d2103bed43fa5e59b04d835d5409', '0x1ac0837dd6c2a1750065158c02a73a1a7c9dae95b398e3bc1d73301c1d88cf8c', '0x3143fcbf9d497bc69c52950c3b4d7aebd70e793113574d854ff54f1426c4aa10', '0x3f118f63a010aa4741445d20ef180d666d026194570cc940355f4e56d6bdf905', '0x58338e3bbf7ca37f156ccf6768651a46d9e3f1aa893235f2248cc391a1c6cd00', '0x44abfa54ec339ad7287aa797148b62aee387672a1d72552b6bde9ab6bf47fc2a', '0x256d0e9133c648964ce3d5583c83dfc9a2774dd8843c940b6770c882630a02f8', '0x3845b63cc6924f105234fbe673546159a9f3b6e2780c7e8d1960b6f4e8b0d27d', '0x2085d78da59214da929d4f5adbf1cfb30d95efd5a29157fe7af9ba27e1c9b807', '0x1edf4b87504c156d2ce81da4f636c7709ee1c7b99f13efd4719f4621e308ea9e', '0x07add95745f693d1119f698f0fe13a22de35f649866874d5821c306bf4a6660f', '0x30ca51700e241210c8d85c4cee8526861e7fe9d3458ee4083a9a5ee9ad59dc9b', '0x4570572601ac5e7f1e8008a891e79747cd0e19376bc6739e7ee581b77e2b953c', '0x23fcb6e2ff8528204b9296493a22728b91c88ad920ca7060d254f59261850af5', '0x0368aff3d7328a0e64a83bbe2611e66e51b45567c6e5aed83632dde7e90bdb7c', '0x218125d0de84f12ddea67ed5a29cfdf4bd93ab44c230c8107d075ad6df0bc730', '0x0f5a6411704c5ff8464305ef67088eee6471225fb1c26d1c1f2252c87c72aa10', '0x5792021e91c1f33abaca9f31c4a6aeb7e35fdd9085b20b9baa9a05cf73fc2abc', '0x345ef96e951f98bccefff151681840726c5a00a6a6cacbd6993cff219d70ccf7', '0x347b3c2e5c39f66fdcccc09f257577cb541c2d93337f19cad9236eff670fd0b6', '0x200329d8869aa7e24387e7a6498ca8db5b9204131e599d781450c8f5dcb5bcc4', '0x46fb5e8c752a5f77d7f006822ecc4bf0959a47cd64ac2ff980b5b15ffc8c267c', '0x2b610b6d4573df14ff30bc6ab1eeecff2458618ed42ba5a1c5494b0a063279b5', '0x19c3e3bef8ba3ccf9ce3afa8c766ac0defaa3f020aca5b906232b658be8c02ce', '0x27729e0dd67210cf2b25b9fc38309ca19e1d8434643c254b4d4530519f8780e3', '0x336229790e28c3ff900924523dea68b95d549dea83e6abe285e917a044fcd446', '0x0f2dc5640a3560c71777f1f9361b23d86d4ff723120ff12515917768b171aa29', '0x337b29a20510a082eddf2a664c3f751a02a1b64be87019f24c33a00c417e6934', '0x46f054fa58cbce40ab7d05992aa6d690daacfa26d531b5844f8d15e7c7199711', '0x1558bca327be73e696ba90d308d6af73d6ba3b60a412ef0c66cbef7fe25aefc5', '0x3741da373085c27346b0801085781b614a54bd4bce4979a525806050792cfd85', '0x4c73aab1a70cec9bd6fa4e3dbaab917fdceeadc6452a40481494aa3a0ec3e0e2', '0x27646d6a85fd310d927c50e3ec5afc220cf8db2a4f6dd94ef5e590ee6d7a673d', '0x46fbb5e5008a603ede864bb1b540cd80aca27338ade25e0daa5b3e0e1ffe495d', '0x16861b90e41936606dd595bafadb6f1b615a83828ed9578f6363e2e55db49241', '0x16def1d6454b6b95a9f4e7ecdc3b804d06335205b58d4eea5292f3eb29b27630', '0x0bf2632473bc139e104177b8bba4f42f34f19180fc3f731f1e06d2fcca485ecf', '0x407317cb9a9a4f51d292b9befde38e46e21a7f134bebb4c44699b19f7a164995', '0x45ba2e0aea07cc2dca14f2bc4f267c585023716fc2177d6eade85936e8295e99', '0x02edce6b996c6348e90ce3b39e21dc171814b410c8f97ffe58d8b8a1fd52a209', '0x075ca2016eebd050f6731e3455df65326b06f90d35e57ad627537d725bed99e7', '0x39a8b129db28d0102c3f0d8e5c5268f279079bab722fbb734b309119f52c56a7', '0x2d7c55f49238262cc59d66cebb3c61dfc4714b2652a80899f714f493c8e47e65', '0x08a53b3d7097bb5ba964a98a2782a1674b2e1d79602c9007bf95da0c693278a4', '0x4d11d0c9f9094891262a839f95fd2bdfab17a3f1344457dee6ff098e36a4c3a4', '0x355bdc00fadfbc92e46c07361d9345bedd2a27a067c8c7caafb330d97b02cd2c', '0x4cf1b0e36496d5befa25f24ac3e69f2cd34b79c9d2b677c4e45d639c98888f00', '0x2bb1f9653c2a884a0a9bb6b5ec152045cc9212a73b20a07bcfda7d5e1a571fed', '0x31043b837f552bdc27046de44875151072980ca74dff1709dcebd840e66f8a7b', '0x5550ce346931f43d02f341a4d0f4c169c035c756947f659c26a44e38f0d16b35', '0x3ea3684fe00c916ea4f297360d5d71d5914a8241f7e799b8d43837a75799e9f7', '0x0381b03d85261c8356386bdc140c182740ded340357ce6762224c02dfe332a04', '0x1736762a7ad020947b0099d319a464abee8ff66525e944e7eaae3e4a9e17d641', '0x0012327fa8efbb86f138a8025737437ed107e984c4efe288cad0fe5707be83d3', '0x1418e4c5a7b9bb66dcdad25b79b42687ecbf0e65a21f9c88d635d886e782793e', '0x256f44b96b0b582ff2d6c9667cf8ef5fe89336b696509aa70557583f91bfb898', '0x0b4a55ece046631e2c748fb620151ccfe71fe6fb7b6bf62d62c4e4c9d9e6f151', '0x19046a787e3c228c76e83d2ac1409d078d9c05816d4f7291400ba5dc9ccb1f88', '0x1d60e8c9db73e89d330903008312a6e10df634bf4615fa6b29a82d4d7097e12c', '0x3b2f06c77ab57b431919786a55c05d17fc540a55a5ee65596d01f9bd1b46c86c', '0x318cbc8fc1698f1fcae480ef4b18e767cffc69f0c571f9bf6453b312108160b0', '0x0c9650dc4d62f866b04059d237576ddc27ea684b59e997f5c003108659c0d7e5', '0x1d5544c0218a37121ffb8ec8719c93f826b7006bfb9abfc20e3ef78ba717b096', '0x2e743c833800188735b462f9b1da4b5c9a82c0b090838cb9c275e17b1bb51856', '0x514b86558a9d8341d6d52242273af87ef88b903d55ae95852a8791c10bbd1d79', '0x482da5ae1e2f0b81dd53d12277df485e2588c60aca052272acbe805930a5da32', '0x12c3a1c03baa37eba429a5a80a6b72160bd5f8839bb4ee12e1d94a7703c429dc', '0x1a56f1e43c596c802db84169fd01dc9511243022261a18001a5e8333eacfeb96', '0x257108ad5fb1eb88bdcd1acbbab1a6254c19dca1e64b506c4c3ad21cee22d143', '0x3fb6750bb473ac6d077f4c9ef45a7b532399c05bbefc87d997c4d369e4095cf8', '0x2470eed5f58a3af4891eb5c65ed54ded32e877fc66135f56f6beb5c5cd2ac36d', '0x180b46226e75d5f6dc7b2704c2020980414d68b38cfaecec7728c245981fcdf5', '0x26c5773d85d0e05de8e55c724d413b39b38fc9687cd3a33f61e6284d41de6ed3', '0x2eb9cfb77d266f014b88a90e75896d7f038019df673cb7a277d34c3e3fa17eff', '0x1c48c9306add329daf89d0f09ed55b903d8c82e3fca6e84daa7410278af86d98', '0x53e8dc910c9ff8f41e29c7826d87fc3591bfc365c8f622ab57f920a63cd8b155', '0x117065a22405feebea2b25f5c6ff8feadafa0f94ba99b1c3cfc5dfe9280b8219', '0x2a3176fcb7a7ac4ab39571b71693707ba1d3504314a66529c019895be8f0a3ce', '0x44150016991f7035254356ea30dc2b868b2868fe0daf7cd7ebe8e2a91cabb8a9', '0x3b0c7be21a559b906ede74566983fdc2e68e5b54c13058d46eef6108da488860', '0x421438710c49d163b1ae4bca529d18c99385a3dad450f438e22780b9d888b306', '0x175350c7a6856639f02656c3fffa28abd7ba69d9cf9539b4fdaddc491902523b', '0x24b48d05697ce26d5b1a9ba388c3426421bdc731543cff90fa8f9bdfe9da075a', '0x0bc75d14d346c9093d625e3fac35fa6e8cc358b5741069824b0b878daf0d4c69', '0x37835f58255cf5ca3e9204c5b29d80f6004f65af0776c5750d2435f319794735', '0x08a8a35f99963376ef2c52ee67a4bd430d58420414248d4b18c86a6ab53d554f', '0x0c052cc4fea6bfc8cb12121666d7be070e62b3c191ca49f65cf866cf058dee7f', '0x0d1ce46d63e4b2ac76f5a3cc30ee164b53f916a8e616ee819fdc033c0557082a', '0x419ca18e6afd4f71c844bc55adf145fca5a49d8f5f59d44a2abde3a939cea030', '0x412b39974f462a151ab451501093ad51f0fe6ba8ea21fdc08c9e72712b95554d', '0x51f63e6cf0b5819f2104023ee2a04bf15e7eb2749c5bf4ae5535ee0eaed1102c', '0x363cbc93a6d0b29dbad98a622e9941d45f1d2158cbef42778ac2c76e63e722b3', '0x295e0e60f56f3b6f36d5382580bfff14d30bf0b069944f46832d6097be312fb9', '0x007a2d34847d833b74d0131ea56624edd451122e90e32cf9e249a827bb44f5f3', '0x581ed0f59a9f5f2d99745a9f623a0170eb42728b4c9bc66d772a309675ad5e3b', '0x05a80ff7418d0a4f2d900da7236dca37dbc610d53330b509bfe3d0624c6746ad', '0x2cc7aa05b074e84b46e21bfba06952761872a0efae4e46c79d4dd43396fc4f93', '0x185ef0d86e6febb95be7044d6d7f2f83c7015bd5bf400da59504fe568c44f4d2', '0x3c151467b58126a35f944d1e5e6b16c48fe21d4312ab6c0409cac51dee718169', '0x13545f3e11b1bfe65d4a40e45dc5d9ffeb3fe3f8290dd061a32fe554f0d47a9f', '0x2da7e740e1d97a21db174c470b1b8de4db7cb0a27d4fcde623331b5518fb2594', '0x149049829c3c540250c67aa57d8103d5a77c9b04cbac3b9a9163ee67a615b055', '0x445e332fa7da07d0b2bf42e1bfdabb2bf3ac1d242484da6f9ae6a2e4a46342d5', '0x1c0c2b971699135a03d282962bf67016072c0b785aea133f450a03a1dbf2b3f4', '0x429d349750a3ba851c67a22b508831a0381001bc48f0ef65f57519867002a684', '0x1d97d71829fcb83a50d0935caef73f4bc97c1613b0f249a80f9765ac8411011d', '0x3c15bcb79543cbac591296c3310a1f1e0fc6f5fd66c9ec492166b0b83e5c361a', '0x49066cb2a7f9caa1bb1166734ffc151a39e7eb48c4d0c163b084fea81988c5a8', '0x11079aa2c6ba7eae2153c5c697e07865f266363024c6aa91e084336354b0da71', '0x15183bb514a28f276de73793b8d4b6d93baae7867894751f1eb4e8c0a5fd3a41', '0x4939eda79ae5c9b00b689ca003fe7897272c348efb697e4a17ae63f23ce3fd8c', '0x09b60d4571cb9a28fe8b2cc816afa42efc01fb4edb7d8a2aa0f301d22de974fb', '0x1f648aec8f4fb92f78b2545153d6c7b690ae0f7767b8787ed917eb496487bcfb', '0x4e8cfc91fd7ce2c3201839dbd859d4e3cb81716213058ba2e461031ca205a4f1', '0x50c9a4066e72296be3069020cea2b789430524e8126a0a37e9c75d1af4b1bf27', '0x23dd5c46fcf0265b5e093d506e6b65d30edcff859282a712014f8ad1dbc8f1e8', '0x50b58ded1c4f819c3c310bde44ff77e0e20d03bd6e3f19cb64e89fe76766258b', '0x01723af3c0f5e10a0bce51b5b43556b64c46ba0503326e3f1c23c88d889240cb', '0x583ffce9cfcd6ec12b51f73a7b2c003d745701d0341ef1dfa54e032242c00b46', '0x5054f3bdf252454f69f5b0ea83154e6291c73f9ec6afa10b79f303dae113bcb7', '0x3f1b46b107803954934733e048ba943e0a9e5edd861afda4cfec100740c46637', '0x3e2c8d473441e25c36716a67af9d334850691e3aed74fea255483ef11ca6b888', '0x47dda6e08a312a306323094de4df68fd712f70e51dad59828fcc9055a7c14fb6', '0x2fd52e618adae5a3e61da438025d2349cb5b80eb266952909f7a9226b76ec951', '0x5294bafe483c44b213bafa794dc1a11d0de52b5694a546a9fa0d35272c6ab80d', '0x021abb00de86cde425d5c3937fdbf1b5869334c035a201e3f7a9e2f4ec5c3245', '0x08af327cb131b9126da080c005f386912fcc940a6edb1dd7a06665c4ad2177fa', '0x45f03afe561d61a5b5bb4dbe529aeb71dad489e531caa21d8ffd12040f14da04', '0x4bf8e98479ad3335de258e3868ec1b66e8a7d83cbd0edb2bdac9cdaf86390268', '0x39ef49b70a8c3cb16e4eb3d03e7aaa59a88dd4c71687ff3adbe244bd3b3ae6a6', '0x4dc7594f97959d57ddb3a018d769042efc56cca1483c0a8db3d616e04dfa6531', '0x4bfc91a99de822b3f94c756282a093a1c108216a1a60f47af93625f1de699ecd', '0x25767883d22ecfcd13b9bfe8cb7baf03c4d9fc2010cbd76424fab4d4dc5d9c24', '0x097145b5dd54acf6359969c921419215a7dda632fdae8f20fecae1bf8a3538b0', '0x19c38d25ecfd1606f6beeb47a81f68a6201a7cc7432466297e11576cea8ef244', '0x35c0dca2cdfc753473a13c0711f72910100a53ffd6f2ac45dcfa19651f95119e', '0x394822daacbc24eac154216a5fd11f6b5ee186ea8f2f16b35c25efc990ccc983', '0x3c7783a59f257f0a67c6949e389fe5c2f46447f74e5a1178bdb883c02b6bc91c', '0x12737b870c7bcdb83924465f80a2c134a17c50af4820237ec1ae4dba3703abf8', '0x3a0cef90f2387db3ab48d9fa4ccd5a1f619623a0cf0de9434f69c2f50e86f8dc', '0x0b6f6c752e5a5302ae7e7a7e60c0adad1cb97ecd7b563733e0f5094711d4d0fd', '0x186647547303e88c407c4a5b6f06d08c00b3c5b16dca84ca885c27d5e5c20b34', '0x3186e88c7e97902b4e2efc5a46027933f0e7f8a1bb6e22c887db793a69dfb290', '0x444ff93ddab0b47b908e32a40a5ba5dad6d99f4c3a55bc45a80ebedc10cb2f18', '0x552cb34d8bfa965ce38c85aaba0ed57b607b95bf6379a48da0c651d8bd9d04e3', '0x4721a7389102584b3c2e9f3ad620bf7d689f924ab2ce453daefecdec0214be61', '0x1cdd4a9dc5162fdc40c696f5e091c9dcc89f917612b76649e7abdf422ec4dc13', '0x4b8307ace60756f14a815d98882aa0d0d1321af266a26ea9c643f70dd068b35c', '0x19a673a2c5b9fa23c733ec7cdc4dfd11f7e0fa6301a292f84edb487b134e455f', '0x5073d8e8d8bb90f7e4c9a1cfd4297912ab87ee67ab95af1a43310d310334ab52', '0x4c838899744dafad14c51607e25df56f62e2a719a22f5e39cec5536d0f5ff626', '0x4a2d80c40eff2bbcf2a9d5e9bd0634c629000da20e3c7476cacf0dda0bc82a9b', '0x3938b10bb04205b68c44b2928ca492aac9f5fe7d3fdc25976de0e59e8b72657f', '0x47919643960bb9c936710c218e9a12cc9a8d137eadee19826b448296bcac0fe3', '0x3f02bd59b39cdc62a0ae04e80206ae72d83646164c31a70f538ea836069cea56', '0x1292be36c75d65602326ebacd3e81f5dfccf92563ad7152ab0efc8fa9b491fb8', '0x313dd896518003d86d0fda62c8ea369629091829d3fb5b86866fba295cdf7e94', '0x0e5b0a62896dd446bd9df89db46b815c430bc6576f54387b79848c895b6a3e71', '0x1adc5146a390dec9dd3b8213df53748145aa8f2a6c1f8f3acdf5c461480af31b', '0x53daa76bd4dadf09b780e86a1ca8836c468b576e3b1b543778b574702240183b', '0x2ef9009941a8ecf691ca793c9912d2749360deee2d52fb934a9eada8fbcaf35d', '0x474e45de7934d016b0b41006145f43a330a47a3130d33c5bdf338b1516a07205', '0x42e85b8919a457de96162d85b3f0003f03a3818bb77b7e89b767f637552c1a91', '0x021f171eeb3e876bb8ba2b57feed89ef2bd6dfffa7b008a32383fb5b55972588', '0x451f4e6ca9d8044904de8ee6df81847fc971aa0c2bbc2e965ce97c9093dba301', '0x3b6208603f532a5af5f8500b2b6569830af1b5e65c04f7e765e30e1023c9c64a', '0x39a9eadb688564ac8323bf437f9e1bdcbfd0e58fc9fed47739639a707847cb4a']

MDS_matrix =  [['0x3b27aa48a03d3af8a7f39325d87e293bae6382bb571e000105e6fc0000000001', '0x428c9f91b444e257bcf2058a938dee63242ff312c201c00126a3db8000000001', '0x353d4c7490371b7963f4d13ba93e584f50265c0f019b0000ebb6493333333334'],['0x428c9f91b444e257bcf2058a938dee63242ff312c201c00126a3db8000000001', '0x353d4c7490371b7963f4d13ba93e584f50265c0f019b0000ebb6493333333334', '0x49f194dac84c89b6d1f077ef4e9db38a99fc636a2ce580014760bb0000000001'],['0x353d4c7490371b7963f4d13ba93e584f50265c0f019b0000ebb6493333333334', '0x49f194dac84c89b6d1f077ef4e9db38a99fc636a2ce580014760bb0000000001', '0x4c0e6d38ce0594f68ecb740c165910714deda8157002000150bb440000000001']]

MDS_matrix_field = matrix(F, t, t)
for i in range(_sage_const_0 , t):
    for j in range(_sage_const_0 , t):
        MDS_matrix_field[i, j] = F(int(MDS_matrix[i][j], _sage_const_16 ))
round_constants_field = []
for i in range(_sage_const_0 , (R_F + R_P) * t):
    round_constants_field.append(F(int(round_constants[i], _sage_const_16 )))

#MDS_matrix_field = MDS_matrix_field.transpose() # QUICK FIX TO CHANGE MATRIX MUL ORDER (BOTH M AND M^T ARE SECURE HERE!)

def print_words_to_hex(words):
    hex_length = int(ceil(float(n) / _sage_const_4 )) + _sage_const_2  # +2 for "0x"
    print(["{0:#0{1}x}".format(int(entry), hex_length) for entry in words])

def print_words_to_ark_ff(words):
    print("[")
    print(",\n".join(["field_new!(Fr,\"{}\")".format(int(entry)) for entry in words]))
    print("]")

def print_concat_words_to_large(words):
    hex_length = int(ceil(float(n) / _sage_const_4 ))
    nums = ["{0:0{1}x}".format(int(entry), hex_length) for entry in words]
    final_string = "0x" + ''.join(nums)
    print(final_string)

def perm(input_words):

    R_f = int(R_F / _sage_const_2 )

    round_constants_counter = _sage_const_0 

    state_words = list(input_words)

    # First full rounds
    for r in range(_sage_const_0 , R_f):
        # Round constants, nonlinear layer, matrix multiplication
        for i in range(_sage_const_0 , t):
            state_words[i] = state_words[i] + round_constants_field[round_constants_counter]
            round_constants_counter += _sage_const_1 
        for i in range(_sage_const_0 , t):
            state_words[i] = (state_words[i])**_sage_const_5 
        state_words = list(MDS_matrix_field * vector(state_words))

    # Middle partial rounds
    for r in range(_sage_const_0 , R_P):
        # Round constants, nonlinear layer, matrix multiplication
        for i in range(_sage_const_0 , t):
            state_words[i] = state_words[i] + round_constants_field[round_constants_counter]
            round_constants_counter += _sage_const_1 
        state_words[_sage_const_0 ] = (state_words[_sage_const_0 ])**_sage_const_5 
        state_words = list(MDS_matrix_field * vector(state_words))

    # Last full rounds
    for r in range(_sage_const_0 , R_f):
        # Round constants, nonlinear layer, matrix multiplication
        for i in range(_sage_const_0 , t):
            state_words[i] = state_words[i] + round_constants_field[round_constants_counter]
            round_constants_counter += _sage_const_1 
        for i in range(_sage_const_0 , t):
            state_words[i] = (state_words[i])**_sage_const_5 
        state_words = list(MDS_matrix_field * vector(state_words))
    
    return state_words


domain_tag = F((_sage_const_1  << arity) - _sage_const_1 )
input_words = [domain_tag, F(_sage_const_1 ), F(_sage_const_2 )]

output_words = perm(input_words)

print("Input:")
print_words_to_hex(input_words)
print("Output:")
print_words_to_ark_ff(output_words)


